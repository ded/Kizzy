/*!
  * Kizzy - a cross-browser LocalStorage API
  * Copyright: Dustin Diaz 2012
  * https://github.com/ded/kizzy
  * License: MIT
  *//*!
  * Kizzy - a cross-browser LocalStorage API
  * Copyright: Dustin Diaz 2012
  * https://github.com/ded/kizzy
  * License: MIT
  */
!function(a,b){typeof module!="undefined"?module.exports=b():typeof define=="function"&&typeof define.amd=="object"?define(b):this[a]=b()}("kizzy",function(){function a(){}function p(){return+(new Date)}function q(a,b){a._[b]&&a._[b].e&&a._[b].e<p()&&a.remove(b)}function r(a){return typeof a=="number"&&isFinite(a)}function s(){if(localStorage.length>0)for(var a in localStorage)if(localStorage.hasOwnProperty(a))try{var b=JSON.parse(localStorage[a]),c,d;for(c in b)b[c]&&b[c].e&&b[c].e<+(new Date)&&(d=!0,delete b[c]);d&&(localStorage[a]=JSON.stringify(b),u(a)===0&&delete localStorage[a])}catch(e){}}function t(a){return localStorage[a]}function u(a){var b=0,c,d;try{d=JSON.parse(localStorage[a]);for(c in d)d.hasOwnProperty(c)&&b++;return b}catch(e){return w(a),0}}function v(a,b,c){try{localStorage[b]=c}catch(d){d==QUOTA_EXCEEDED_ERR&&x()}return c}function w(a){delete localStorage[a]}function x(){localStorage.clear()}function y(){throw"NotImplemented"}function z(){throw"NotImplemented"}function A(a){var b=j.childNodes,c,d=null;for(var e=0,f=b.length;e<f;e++){c=b.item(e);if(c.getAttribute("key")==a){d=c;break}}return d}function B(a){var b=A(a),c=null;return b&&(c=b.getAttribute("value")),c}function C(a,b,c){var d=A(b);return d?d.setAttribute("value",c):(d=i.createNode(1,"item",""),d.setAttribute("key",b),d.setAttribute("value",c),j.appendChild(d)),h.save(store),c}function D(a){A(a)&&j.removeChild(node),h.save(store)}function E(){while(j.firstChild)j.removeChild(j.firstChild);h.save(store)}function F(){this._={}}function G(a,b){this.timeout=b,this.ns=a,this._=JSON.parse(m(a)||"{}")}function H(a,b){return b=r(b)?b:18e4,new G(a,b)}var b,c=null,d=0,e=function(){return 1};try{c=document,store=c.domain}catch(f){}try{b=!!localStorage||!!globalStorage,localStorage||(localStorage=globalStorage[store]),d=1}catch(g){d=0;try{if(c.documentElement.addBehavior){d=0,b=1;var h=c.documentElement;h.addBehavior("#default#userData"),h.load(store);var i=h.xmlDocument,j=i.documentElement}}catch(k){b=!1}}var l=a,m=a,n=a,o=a;return b&&(l=d?v:C,m=d?t:B,getNsLocalStorageSize=d?u:z,n=d?w:D,o=d?x:E,clearAllExpireds=d?s:y,e=function(a){try{var b=JSON.stringify(a._);return b=="{}"?n(a.ns):l(a,a.ns,b),1}catch(c){return 0}}),F.prototype={set:function(a,b,c){return clearAllExpireds(),this._[a]={value:b,e:r(c)?p()+c:this.timeout&&r(this.timeout)?p()+this.timeout:0},e(this)||this.remove(a),b},get:function(a){return q(this,a),this._[a]?this._[a].value:undefined},remove:function(a){delete this._[a],e(this)},getSize:function(){return this.clearExpireds(),getNsLocalStorageSize(this.ns)},clear:function(){this._={},e(this)},clearExpireds:function(){for(var a in this._)q(this,a);e(this)}},G.prototype=F.prototype,H.remove=n,H.clear=o,H.clearAllExpireds=clearAllExpireds,H})